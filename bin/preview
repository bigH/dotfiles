#!/usr/bin/env bash

if [ "$#" -ne 1 ]; then
  echo "ERROR: exactly one argument required."
elif [ -f "$1" ]; then
  FILE=$(basename -- "$1")
  EXT=$(echo "$FILE" | sed 's/^.*\.//')

  case "$EXT" in
    rb)
      cat "$1" | \
      grep --color=never -E "(^[[:space:]]*module |^[[:space:]]*class |^[[:space:]]*def |^[[:space:]]*extend |^[[:space:]]*describe |^[[:space:]]*it )"
      ;;
    jsx)
      cat "$1" | \
      grep --color=never -E "(^[[:space:]]*export |^[[:space:]]*constructor\\( |^[[:space:]]*.*\\=.*\\=>.*|^[[:space:]]*function )" | grep "{$" | \
        sed 's/=>[[:space:]]{$/=> {}/' | sed 's/[[:space:]]*{$//'
      ;;
    *)
      cat "$1"
      exit 1
      ;;
  esac
elif [ -d "$1" ]; then
  gls --color=always -G "$1"
else
  echo "ERROR: '$1' does not exist or is not a file."
fi

